!(function (e, t) {
  "object" == typeof exports && "object" == typeof module
    ? (module.exports = t(require("tinymce")))
    : "function" == typeof define && define.amd
    ? define(["tinymce"], t)
    : "object" == typeof exports
    ? (exports["tinymce-paste-from-word-plugin"] = t(require("tinymce")))
    : (e["tinymce-paste-from-word-plugin"] = t(e.tinymce));
})(this, (e) =>
  (() => {
    "use strict";
    var t = {
        746: (t) => {
          t.exports = e;
        },
      },
      r = {};
    function n(e) {
      var a = r[e];
      if (void 0 !== a) return a.exports;
      var i = (r[e] = { exports: {} });
      return t[e](i, i.exports, n), i.exports;
    }
    (n.n = (e) => {
      var t = e && e.__esModule ? () => e.default : () => e;
      return n.d(t, { a: t }), t;
    }),
      (n.d = (e, t) => {
        for (var r in t)
          n.o(t, r) &&
            !n.o(e, r) &&
            Object.defineProperty(e, r, { enumerable: !0, get: t[r] });
      }),
      (n.o = (e, t) => Object.prototype.hasOwnProperty.call(e, t)),
      (n.r = (e) => {
        "undefined" != typeof Symbol &&
          Symbol.toStringTag &&
          Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }),
          Object.defineProperty(e, "__esModule", { value: !0 });
      });
    var a = {};
    return (
      (() => {
        n.r(a);
        var e = n(746),
          t = n.n(e);
        var r = function (e) {
            var r = !1;
            return (
              (e = e.replace(/^[\u00a0 ]+/, "")),
              t().util.Tools.each(
                [
                  /^[IVXLMCD]+\.[ \u00a0]/,
                  /^[ivxlmcd]+\.[ \u00a0]/,
                  /^[a-z]{1,2}[\.\)][ \u00a0]/,
                  /^[A-Z]{1,2}[\.\)][ \u00a0]/,
                  /^[0-9]+\.[ \u00a0]/,
                  /^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,
                  /^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/,
                ],
                function (t) {
                  if (t.test(e)) return (r = !0), !1;
                }
              ),
              r
            );
          },
          i = function (e, r, n) {
            var a = {},
              i = t().DOM.parseStyle(n);
            return (
              t().util.Tools.each(i, function (e, t) {
                switch (t) {
                  case "mso-list":
                    var i = /\w+ \w+([0-9]+)/i.exec(n);
                    i && (r._listLevel = parseInt(i[1], 10)),
                      /Ignore/i.test(e) &&
                        r.firstChild &&
                        ((r._listIgnore = !0), (r.firstChild._listIgnore = !0));
                    break;
                  case "horiz-align":
                    t = "text-align";
                    break;
                  case "vert-align":
                    t = "vertical-align";
                    break;
                  case "font-color":
                  case "mso-foreground":
                    t = "color";
                    break;
                  case "mso-background":
                  case "mso-highlight":
                    t = "background";
                    break;
                  case "font-weight":
                  case "font-style":
                    return void ("normal" !== e && (a[t] = e));
                  case "mso-element":
                    if (/^(comment|comment-list)$/i.test(e))
                      return void r.remove();
                }
                0 !== t.indexOf("mso-comment")
                  ? 0 !== t.indexOf("mso-") && (a[t] = e)
                  : r.remove();
              }),
              /(bold)/i.test(a["font-weight"]) &&
                (delete a["font-weight"], r.wrap(new (t().html.Node)("b", 1))),
              /(italic)/i.test(a["font-style"]) &&
                (delete a["font-style"], r.wrap(new (t().html.Node)("i", 1))),
              t().DOM.serializeStyle(a, r.name) || null
            );
          },
          o = function (e, n) {
            n = (function (e, r) {
              return (
                t().util.Tools.each(r, function (t) {
                  e =
                    t.constructor === RegExp
                      ? e.replace(t, "")
                      : e.replace(t[0], t[1]);
                }),
                e
              );
            })(n, [
              /<br class="?Apple-interchange-newline"?>/gi,
              /<b[^>]+id="?docs-internal-[^>]*>/gi,
              /<!--[\s\S]+?-->/gi,
              /<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,
              [/<(\/?)s>/gi, "<$1strike>"],
              [/&nbsp;/gi, " "],
              [
                /<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,
                function (e, t) {
                  return t.length > 0
                    ? t
                        .replace(/./, " ")
                        .slice(Math.floor(t.length / 2))
                        .split("")
                        .join(" ")
                    : "";
                },
              ],
            ]);
            var a = e.getParam(
                "pastefromword_valid_elements",
                "-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody"
              ),
              o = t().html.Schema({
                valid_elements: a,
                valid_children: "-li[p]",
              });
            t().util.Tools.each(o.elements, function (e) {
              e.attributes.class ||
                ((e.attributes.class = {}), e.attributesOrder.push("class")),
                e.attributes.style ||
                  ((e.attributes.style = {}), e.attributesOrder.push("style"));
            });
            var s = t().html.DomParser({}, o);
            s.addAttributeFilter("style", function (e) {
              for (var t, r = e.length; r--; )
                (t = e[r]).attr("style", i(0, t, t.attr("style"))),
                  "span" === t.name &&
                    t.parent &&
                    !t.attributes.length &&
                    t.unwrap();
            }),
              s.addAttributeFilter("class", function (e) {
                for (var t, r, n = e.length; n--; )
                  (r = (t = e[n]).attr("class")),
                    /^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(r) &&
                      t.remove(),
                    t.attr("class", null);
              }),
              s.addNodeFilter("del", function (e) {
                for (var t = e.length; t--; ) e[t].remove();
              }),
              s.addNodeFilter("a", function (e) {
                for (var t, r, n, a = e.length; a--; )
                  if (
                    ((r = (t = e[a]).attr("href")),
                    (n = t.attr("name")),
                    r && -1 !== r.indexOf("#_msocom_"))
                  )
                    t.remove();
                  else if (
                    (r &&
                      0 === r.indexOf("file://") &&
                      (r = r.split("#")[1]) &&
                      (r = "#" + r),
                    r || n)
                  ) {
                    if (n && !/^_?(?:toc|edn|ftn)/i.test(n)) {
                      t.unwrap();
                      continue;
                    }
                    t.attr({ href: r, name: n });
                  } else t.unwrap();
              });
            var l = s.parse(n);
            return (
              e.getParam("pastefromword_convert_fake_lists", !0) &&
                (function (e) {
                  for (
                    var n,
                      a,
                      i = 1,
                      o = function (e) {
                        var t = "";
                        if (3 === e.type) return e.value;
                        if ((e = e.firstChild))
                          do {
                            t += o(e);
                          } while ((e = e.next));
                        return t;
                      },
                      s = function (e, t) {
                        if (3 === e.type && t.test(e.value))
                          return (e.value = e.value.replace(t, "")), !1;
                        if ((e = e.firstChild))
                          do {
                            if (!s(e, t)) return !1;
                          } while ((e = e.next));
                        return !0;
                      },
                      l = function (e) {
                        if (e._listIgnore) e.remove();
                        else if ((e = e.firstChild))
                          do {
                            l(e);
                          } while ((e = e.next));
                      },
                      u = function (e, r, o) {
                        var u = e._listLevel || i;
                        u !== i &&
                          (u < i
                            ? n && (n = n.parent.parent)
                            : ((a = n), (n = null))),
                          n && n.name === r
                            ? n.append(e)
                            : ((a = a || n),
                              (n = new (t().html.Node)(r, 1)),
                              o > 1 && n.attr("start", "" + o),
                              e.wrap(n)),
                          (e.name = "li"),
                          u > i && a && a.lastChild.append(n),
                          (i = u),
                          l(e),
                          s(e, /^\u00a0+/),
                          s(e, /^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),
                          s(e, /^\u00a0+/);
                      },
                      c = [],
                      f = e.firstChild;
                    null != f;

                  )
                    if ((c.push(f), null !== (f = f.walk())))
                      for (; void 0 !== f && f.parent !== e; ) f = f.walk();
                  for (var d = 0; d < c.length; d++)
                    if ("p" === (e = c[d]).name && e.firstChild) {
                      var m = o(e);
                      if (/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(m)) {
                        u(e, "ul");
                        continue;
                      }
                      if (r(m)) {
                        var p = /([0-9]+)\./.exec(m),
                          h = 1;
                        p && (h = parseInt(p[1], 10)), u(e, "ol", h);
                        continue;
                      }
                      if (e._listLevel) {
                        u(e, "ul", 1);
                        continue;
                      }
                      n = null;
                    } else (a = n), (n = null);
                })(l),
              t().html.Serializer({}, o).serialize(l)
            );
          };
        t().PluginManager.add("paste_from_word", function (e) {
          return (
            e.on("PastePreProcess", function (t) {
              var r;
              (r = t.content),
                (/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(
                  r
                ) ||
                  /class="OutlineElement/.test(r) ||
                  /id="?docs\-internal\-guid\-/.test(r)) &&
                  (t.content = o(e, t.content));
            }),
            {
              getMetadata: function () {
                return {
                  name: "Paste from Word",
                  url: "https://github.com/pangaeatech/tinymce-paste-from-word-plugin",
                };
              },
            }
          );
        });
      })(),
      a
    );
  })()
);
